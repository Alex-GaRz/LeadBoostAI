# ============================================================
# FASE 3: SECURITY, IAM & SECRET MANAGEMENT
# RFC-PHOENIX-03 Configuration
# ============================================================

# --- SECRET MANAGEMENT ---
# Tipo de proveedor de secretos
# Valores: local | vault | aws_kms | gcp_secret
SECRET_PROVIDER=local

# HashiCorp Vault (si SECRET_PROVIDER=vault)
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=s.xxxxxxxxxxxxxxxxxxxxxxxx
VAULT_NAMESPACE=leadboostai

# AWS KMS (si SECRET_PROVIDER=aws_kms)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key

# GCP Secret Manager (si SECRET_PROVIDER=gcp_secret)
GCP_PROJECT_ID=your-project-id
GCP_CREDENTIALS_PATH=/path/to/credentials.json

# --- MUTUAL TLS (mTLS) ---
# Habilitar mTLS entre servicios
MTLS_ENABLED=false  # Cambiar a 'true' en producción

# Modo de operación mTLS
# - permissive: Certificado opcional (desarrollo)
# - strict: Certificado obligatorio (producción)
MTLS_MODE=permissive

# --- SECURITY TOKEN SERVICE (STS) ---
# URL del STS para obtener tokens
STS_URL=http://enterprise:8011/sts/token

# Claves de firma del STS (generadas automáticamente)
# Estas se almacenan en certs/sts/ y se cargan desde allí
# STS_PRIVATE_KEY=...
# STS_PUBLIC_KEY=...
# STS_KEY_ID=key-001

# Configuración de tokens
TOKEN_EXPIRATION_MINUTES=15
TOKEN_MAX_EXPIRATION_MINUTES=60

# --- SERVICE CLIENT SECRETS ---
# Secretos para autenticación servicio-a-servicio
# IMPORTANTE: Después de correcciones de Auditor, estos secretos son OBLIGATORIOS
# NO hay fallback. Cada servicio debe tener su client_secret configurado.
# En producción: rotar periódicamente y almacenar en Vault

# Formato: {SERVICE_ID_UPPERCASE}_CLIENT_SECRET
# Ejemplo: SVC.ACTUATOR -> ACTUATOR_CLIENT_SECRET (sin el prefijo svc.)

ENTERPRISE_CLIENT_SECRET=dev_secret_enterprise_001
ACTUATOR_CLIENT_SECRET=dev_secret_actuator_002
ANALYST_CLIENT_SECRET=dev_secret_analyst_003
OPTIMIZER_CLIENT_SECRET=dev_secret_optimizer_004
MEMORY_CLIENT_SECRET=dev_secret_memory_005
BFF_CLIENT_SECRET=dev_secret_bff_006
SCOUT_CLIENT_SECRET=dev_secret_scout_007

# --- IAM / RBAC ---
# Nivel de auditoría
# Valores: all | security | none
AUDIT_LEVEL=all

# Política por defecto
# Valores: allow | deny (recomendado: deny)
DEFAULT_IAM_POLICY=deny

# --- API KEYS (Servicios Externos) ---
# IMPORTANTE: En producción usar Secret Manager, NO variables de entorno

# OpenAI
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_ORG_ID=org-xxxxxxxxxxxxxxxxxxxxx

# Meta Ads
META_ACCESS_TOKEN=EAAxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
META_APP_ID=123456789012345
META_APP_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Google Ads
GOOGLE_ADS_DEVELOPER_TOKEN=xxxxxxxxxxxxxxxxxxxxx
GOOGLE_ADS_CLIENT_ID=xxxxxxxxxxxxxxxxxxxxx
GOOGLE_ADS_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxx
GOOGLE_ADS_REFRESH_TOKEN=xxxxxxxxxxxxxxxxxxxxx

# --- DATABASE ---
DATABASE_URL=postgresql://admin:password_seguro_123@localhost:5432/leadboost_cold_store

# --- REDIS / EVENT BUS ---
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# --- LOGGING ---
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FORMAT=json  # json | text

# --- MONITORING ---
# Sentry (opcional)
SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxx@sentry.io/xxxxxxx
SENTRY_ENVIRONMENT=development  # development | staging | production

# --- FEATURE FLAGS ---
# Habilitar/deshabilitar features de seguridad para testing
SECURITY_ENABLED=true
JWT_VALIDATION_ENABLED=true
RBAC_ENFORCEMENT_ENABLED=true
AUDIT_ENABLED=true

# ============================================================
# NOTAS DE SEGURIDAD
# ============================================================
# 
# 1. NUNCA commitear este archivo con valores reales
# 2. En producción, usar Secret Manager (Vault/KMS)
# 3. Rotar secretos cada 30-90 días
# 4. Usar MTLS_MODE=strict en producción
# 5. Monitorear logs de auditoría regularmente
# 6. Limitar permisos al mínimo necesario (Principle of Least Privilege)
# 
# ============================================================
